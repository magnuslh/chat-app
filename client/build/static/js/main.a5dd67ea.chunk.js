(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{124:function(e,t){},133:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(81),s=n.n(c),l=(n(91),n(41)),o=n(20),u=n.n(o),i=n(42),f=n(16),m=n(50),d=n(82),v=n(24),g=function(e){var t=e.sendMessage,n=Object(a.useState)(""),c=Object(f.a)(n,2),s=c[0],l=c[1],o=function(){""!==s&&(t(s),l(""))};return r.a.createElement("div",{className:"w-full p-4 flex bg-gray-200"},r.a.createElement("input",{type:"text",name:"message",value:s,onChange:function(e){return l(e.target.value)},className:"rounded p-3 pl-6 flex-grow shadow",placeholder:"Say something...",onKeyPress:function(e){13===e.charCode&&o()}}),r.a.createElement("button",{className:"bg-blue-500 text-white rounded p-3 ml-2 shadow ",onClick:o},"Send"))},p=function(e){var t=e.createdAt,n=e.isSender,c=e.text,s=Object(a.useState)(!1),l=Object(f.a)(s,2),o=l[0],u=l[1];console.log(t);var i=n?"bg-blue-500 text-white ":"bg-gray-200 text-gray-900 ",m=new Date(t),d=m.getMinutes(),v=""+d;d<10&&(v="0"+d);var g=m.getHours()+":"+v,p=o?"visible":"invisible";return r.a.createElement("div",{className:"flex items-center"},n?r.a.createElement("div",{className:"text-gray-300 text-xs m-2 ".concat(p)},g):null,r.a.createElement("div",{onMouseOver:function(){return u(!0)},onMouseLeave:function(){return u(!1)},className:i+" inline-block rounded p-2 shadow-md"},c),n?null:r.a.createElement("div",{className:"text-gray-300 text-xs m-2 ".concat(p)},g))},b=function(e){var t=e.clients,n="";return n=0===t.length?"Looks you are the only one here":t.join(", "),r.a.createElement("div",{className:"w-full p-6 text-lg bg-gray-200 text-center text-gray-700 font-bold shadow-lg"},n)},h=function(e){var t=e.isSender,n=e.sender,a=e.children;return t?r.a.createElement("div",{className:"p-2 m-1  self-end text-right"},r.a.createElement("span",{className:" text-gray-700"},n),r.a.createElement("div",{className:"flex flex-col items-end space-y-1"},a)):r.a.createElement("div",{className:"p-2 m-1  self-start text-left "},r.a.createElement("span",{className:" text-gray-700"},n),r.a.createElement("div",{className:"flex flex-col items-start space-y-1"},a))},x=function(e){var t=e.sendMessage,n=e.clearMessages,c=e.clients,s=e.nickname,o=e.messages,u=Object(a.useState)([]),i=Object(f.a)(u,2),m=i[0],d=i[1],v=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=[],t=0,n=(o.map((function(n,a){0==a?e[t]=[n]:a>0&&n.sender===o[a-1].sender?e[t]=[].concat(Object(l.a)(e[t]),[n]):e[t+=1]=[n]})),e.map((function(e,t){var n=e[0].sender===s,a=e.map((function(e,t){return r.a.createElement(p,{isSender:n,createdAt:e.createdAt,key:t,text:e.text})}));return r.a.createElement(h,{isSender:n,sender:e[0].sender,key:t},a)})));console.log(e),d(n)}),[o,s]),Object(a.useEffect)((function(){v.current.scrollIntoView({behavior:"smooth"})}),[m]),r.a.createElement("div",{className:"w-full h-screen bg-gray-500 flex flex-col justify-end"},r.a.createElement(b,{clients:c}),r.a.createElement("div",{className:"w-full h-full flex flex-col p-4 overflow-y-scroll"},m.length>0?r.a.createElement("button",{className:"text-gray-400",onClick:n},"Clear All"):r.a.createElement("span",null),m,r.a.createElement("div",{ref:v})),r.a.createElement(g,{sendMessage:t}))};function y(){var e=Object(m.a)(["\n  mutation {\n    clearMessages {\n      success\n    }\n  }\n"]);return y=function(){return e},e}function E(){var e=Object(m.a)(["\n  query {\n    messages {\n      sender\n      text\n      createdAt\n      updatedAt\n    }\n  }\n"]);return E=function(){return e},e}var w=n(93)("/"),j=Object(v.createHttpLink)({uri:"/graphql"}),O=new v.ApolloClient({link:j,cache:new v.InMemoryCache}),k=Object(v.gql)(E()),N=Object(v.gql)(y());var M=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)([]),o=Object(f.a)(s,2),m=o[0],v=o[1],g=Object(d.useStateWithCallbackLazy)(""),p=Object(f.a)(g,2),b=p[0],h=p[1],y=function(){var e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.mutate({mutation:N});case 3:t=e.sent,t.data,c([]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){return function(){var e=Object(i.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.query({query:k});case 3:t=e.sent,n=t.data.messages,console.log(n),c(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}()(),w.on("bcMessage",(function(e){c((function(t){return[].concat(Object(l.a)(t),[e])}))})),w.on("nickname",(function(e,t,n){h(e,(function(){n()}));var a=t.filter((function(t){return t!==e}));v(a)})),function(){return w.disconnect()}}),[]),Object(a.useEffect)((function(){w.on("connectedClients",(function(e){var t=e.filter((function(e){return e!==b}));v(t)}))}),[b]);var E=function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(b),n={text:t,sender:b},w.emit("newMessage",n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(x,{clients:m,nickname:b,messages:n,clearMessages:function(){return y()},sendMessage:function(e){return E(e)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},86:function(e,t,n){e.exports=n(133)},91:function(e,t,n){}},[[86,1,2]]]);
//# sourceMappingURL=main.a5dd67ea.chunk.js.map